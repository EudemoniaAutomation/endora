<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Endora ‚Äî happier guests, more revenue, less work</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  :root{
    --bg:#000; --ink:#fff; --muted:#9fb0c4;
    --acc:#4A90E2; --acc2:#6BA3F5; --card:rgba(16,16,20,.85);
    --ring:rgba(74,144,226,.25); --wall:url('https://d1yei2z3i6k35z.cloudfront.net/12820362/68a47346dc795_ModernCozyLivingRoom.jpeg?width=1920');
    --qr:180px; --bubble:60px;
  }
  body{background:#000;color:#fff;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;overflow-x:hidden}
  /* Ambient bg */
  body::before{
    content:"";position:fixed;inset:0;z-index:0;
    background:
      radial-gradient(60vw 60vw at 10% 40%, rgba(74,144,226,.18), transparent 60%),
      radial-gradient(60vw 60vw at 90% 80%, rgba(74,144,226,.10), transparent 60%),
      linear-gradient(180deg,#02050a 0%, #0a0f18 100%);
    animation:bgShift 20s ease-in-out infinite;
  }
  @keyframes bgShift{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}
  /* Floating particles */
  .particles{position:fixed;inset:0;pointer-events:none;z-index:1}
  .particle{position:absolute;width:2px;height:2px;background:var(--acc);border-radius:50%;opacity:0;box-shadow:0 0 10px var(--acc2);animation:float 16s linear infinite}
  @keyframes float{0%{transform:translateY(100vh);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-120vh);opacity:0}}
  .container{position:relative;z-index:2;max-width:1200px;margin:0 auto;padding:40px 20px}
  /* Hero */
  .hero{text-align:center;padding:84px 0 56px;animation:fadeUp .9s ease}
  @keyframes fadeUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}
  .hero-badge{display:inline-block;padding:8px 18px;border-radius:999px;border:1px solid var(--ring);
    background:linear-gradient(135deg,rgba(74,144,226,.15),rgba(74,144,226,.04));color:#8ec1ff;
    font-size:12px;letter-spacing:2px;text-transform:uppercase;margin-bottom:24px}
  .hero h1{
    font-size:clamp(2.4rem,7vw,4.2rem);font-weight:900;line-height:1.08;margin-bottom:14px;
    background:conic-gradient(from 20deg at 0% 0%,#fff 0%, #cfe5ff 25%, var(--acc) 55%, #fff 85%);
    -webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;
    text-shadow:0 0 80px rgba(74,144,226,.45);
    background-size:200% 200%;animation:titleSheen 7s ease-in-out infinite;
  }
  @keyframes titleSheen{0%{background-position:0% 0%}50%{background-position:100% 100%}100%{background-position:0% 0%}}
  .hero p{color:var(--muted);max-width:760px;margin:0 auto 28px;font-size:1.08rem;line-height:1.6}
  .ctas{display:flex;gap:14px;flex-wrap:wrap;justify-content:center}
  .btn{display:inline-flex;align-items:center;gap:10px;padding:18px 32px;border-radius:999px;font-weight:800;text-decoration:none}
  .btn.primary{color:#02121f;background:linear-gradient(135deg,var(--acc),var(--acc2));box-shadow:0 0 40px rgba(74,144,226,.45)}
  .btn.primary:hover{transform:translateY(-2px);box-shadow:0 12px 48px rgba(74,144,226,.6)}
  .btn.ghost{color:#8ec1ff;border:2px solid var(--acc);background:transparent}
  .btn.ghost:hover{background:var(--acc);color:#03111e}

  /* Demo card */
  .demo{margin:60px 0}
  .card{position:relative;overflow:hidden;border-radius:28px;padding:38px 26px;text-align:center;
    border:1px solid rgba(74,144,226,.18);background:linear-gradient(135deg,rgba(20,20,24,.9),rgba(20,20,24,.75));backdrop-filter:blur(18px)}
  .card::before{
    content:"";position:absolute;inset:14px;border-radius:22px;z-index:0;
    background-image:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.55)), var(--wall);
    background-size:cover;background-position:center;
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.05);
  }
  .card h2,.card p,.chat-wrap,.qr{position:relative;z-index:1}
  .card h2{font-size:2rem;font-weight:800;margin-bottom:10px}
  .card p{color:var(--muted);margin-bottom:22px}

  /* Chat */
  .chat-wrap{display:grid;gap:18px;justify-items:center}
  .chat{width:min(520px,92vw);height:500px;border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.12);
    background:rgba(8,12,18,.85);backdrop-filter:blur(16px);display:flex;flex-direction:column;box-shadow:0 24px 60px rgba(0,0,0,.55)}
  .chat .hdr{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;
    color:#00172c;background:linear-gradient(90deg,var(--acc),var(--acc2));font-weight:900}
  .hdr .sparkle{display:inline-grid;place-items:center;width:22px;height:22px;border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #fff 0 30%, transparent 35%);
    animation:pulse 2.2s ease-in-out infinite}
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}
  .log{flex:1;overflow:auto;padding:16px;background:rgba(3,8,14,.55);display:flex;flex-direction:column;gap:10px}
  .msg{max-width:85%;padding:12px 14px;border-radius:16px;font-size:14px;line-height:1.5;border:1px solid rgba(255,255,255,.08);animation:pop .2s ease}
  @keyframes pop{from{transform:scale(.96);opacity:.4}to{transform:scale(1);opacity:1}}
  .msg.user{align-self:flex-end;background:linear-gradient(135deg,rgba(74,144,226,.22),rgba(74,144,226,.08));color:#fff;border-color:rgba(74,144,226,.3)}
  .msg.bot{align-self:flex-start;background:rgba(255,255,255,.06);color:#e8eef7}
  .msg a{color:#9fd0ff;text-decoration:underline;font-weight:700}
  .msg a:hover{text-decoration:none;filter:brightness(1.1)}
  .input{position:relative;display:flex;border-top:1px solid rgba(74,144,226,.2);background:rgba(6,10,16,.9)}
  .input input{flex:1;background:transparent;border:0;color:#fff;padding:14px 16px;font-size:14px;outline:none}
  .input input::placeholder{color:#8295ad}
  .input button{background:linear-gradient(135deg,var(--acc),var(--acc2));color:#00172c;border:0;padding:0 20px;font-weight:900;cursor:pointer}
  /* Waiting animation */
  .input.waiting::after{
    content:"";position:absolute;left:0;right:0;bottom:0;height:2px;
    background:linear-gradient(90deg,transparent,var(--acc),transparent);background-size:200% 100%;
    animation:bar 1.6s ease-in-out infinite;opacity:.7
  }
  @keyframes bar{0%{background-position:-50% 0}100%{background-position:150% 0}}
  .typing{position:absolute;left:12px;bottom:52px;display:flex;gap:8px;align-items:center;
    background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);padding:8px 10px;border-radius:14px;
    backdrop-filter:blur(10px);opacity:0;transform:translateY(6px);transition:.25s}
  .typing.show{opacity:1;transform:translateY(0)}
  .typing .dot{width:6px;height:6px;border-radius:50%;background:#e5e7eb;opacity:.8;animation:bounce 1.2s infinite ease-in-out}
  .typing .dot:nth-child(2){animation-delay:.15s}.typing .dot:nth-child(3){animation-delay:.3s}
  @keyframes bounce{0%,80%,100%{transform:translateY(0);opacity:.5}40%{transform:translateY(-6px);opacity:1}}

  /* QR + bubble */
  .qr{display:flex;gap:26px;align-items:center;justify-content:center;margin-top:6px}
  .qr-wrap{position:relative;width:var(--qr);height:var(--qr)}
  .qr-box{position:absolute;inset:0;border-radius:22px;background:linear-gradient(135deg,rgba(255,255,255,.96),rgba(255,255,255,.9));
    border:1px solid rgba(0,0,0,.08);display:grid;place-items:center;box-shadow:0 20px 60px rgba(74,144,226,.35), inset 0 0 20px rgba(74,144,226,.12);animation:qrGlow 3s infinite}
  @keyframes qrGlow{0%,100%{box-shadow:0 20px 60px rgba(74,144,226,.35), inset 0 0 20px rgba(74,144,226,.12)}50%{box-shadow:0 22px 80px rgba(74,144,226,.55), inset 0 0 30px rgba(74,144,226,.2)}}
  .qr-box img{width:100%;height:100%;object-fit:contain}
  .bubble{position:absolute;right:-10px;bottom:-10px;width:var(--bubble);height:var(--bubble);border-radius:50%;display:grid;place-items:center;cursor:pointer;
    background:linear-gradient(135deg,var(--acc),var(--acc2));color:#00172c;font-size:22px;box-shadow:0 10px 40px rgba(74,144,226,.55), inset 0 -3px 12px rgba(0,0,0,.25);animation:pop2 2s infinite}
  @keyframes pop2{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
  .qr-info{color:var(--muted);font-size:.95rem;max-width:320px;text-align:center}
  .qr-info strong{display:block;color:#9fd0ff;margin-bottom:6px}

  /* ‚ÄúHow it works‚Äù + features */
  .section{margin:90px 0}
  .section h2{font-size:2.6rem;text-align:center;font-weight:800;margin-bottom:10px;
    background:linear-gradient(135deg,#fff 0%,var(--acc) 100%);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
  .section p.sub{color:var(--muted);text-align:center;max-width:720px;margin:0 auto 34px}
  .steps{display:grid;grid-template-columns:repeat(4,1fr);gap:24px}
  .step{background:linear-gradient(135deg,rgba(20,20,24,.9),rgba(20,20,24,.75));border:1px solid rgba(74,144,226,.18);
    padding:22px;border-radius:18px;text-align:center}
  .num{width:74px;height:74px;border-radius:50%;display:grid;place-items:center;margin:0 auto 12px;
    background:linear-gradient(135deg,var(--acc),var(--acc2));color:#02121f;font-size:1.8rem;font-weight:900;box-shadow:0 10px 26px rgba(74,144,226,.35)}
  .step h4{color:#9fd0ff;margin-bottom:8px}
  .step p{color:var(--muted)}

  .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-top:28px}
  .feature{display:flex;align-items:center;gap:14px;background:linear-gradient(135deg,rgba(20,20,24,.9),rgba(20,20,24,.75));
    border:1px solid rgba(74,144,226,.18);padding:20px;border-radius:14px}
  .tick{width:42px;height:42px;border-radius:50%;display:grid;place-items:center;background:var(--acc);color:#00172c;font-weight:900}

  /* Pricing */
  .pricing{margin-top:70px}
  .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:18px}
  .price{background:linear-gradient(135deg,rgba(20,20,24,.92),rgba(20,20,24,.8));border:1px solid rgba(74,144,226,.18);border-radius:16px;padding:18px}
  .price h3{font-size:1.05rem;margin-bottom:8px}
  .row{display:flex;justify-content:space-between;align-items:baseline;gap:10px}
  .amt{font-weight:900;font-size:1.1rem;white-space:nowrap}
  .amt .e{margin-right:4px}
  .price p{color:#c6d3e5;font-size:.95rem;margin-top:6px;line-height:1.45}
  .hint{color:#8aa1bb;text-align:center;margin-top:8px;font-size:.9rem}

  /* Footer */
  .footer{margin:90px 0 30px;text-align:center}
  .btnbar{display:flex;gap:18px;flex-wrap:wrap;justify-content:center;background:linear-gradient(180deg,#0e141f,#0a0f18);border:1px solid rgba(74,144,226,.18);padding:18px;border-radius:999px;box-shadow:0 24px 60px rgba(0,0,0,.5)}
  .btnbar .btn{padding:16px 28px}
  .links{margin-top:16px}
  .links a{color:#9db4d1;text-decoration:none;margin:0 12px}
  .links a:hover{color:#9fd0ff}

  @media (max-width:900px){.steps{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:640px){
    .container{padding:0 14px}
    .hero h1{font-size:2.3rem}
    .steps{grid-template-columns:1fr}
    .chat{height:460px}
    .qr{flex-direction:column}
  }
</style>
</head>
<body>

<!-- tiny particles -->
<div class="particles" aria-hidden="true">
  <div class="particle" style="left:8%;animation-delay:0s"></div>
  <div class="particle" style="left:18%;animation-delay:2s"></div>
  <div class="particle" style="left:28%;animation-delay:4s"></div>
  <div class="particle" style="left:40%;animation-delay:6s"></div>
  <div class="particle" style="left:52%;animation-delay:8s"></div>
  <div class="particle" style="left:65%;animation-delay:10s"></div>
  <div class="particle" style="left:77%;animation-delay:12s"></div>
  <div class="particle" style="left:88%;animation-delay:14s"></div>
</div>

<div class="container">
  <!-- HERO -->
  <section class="hero">
    <div class="hero-badge">‚ú® Premium guest experience</div>
    <h1>Endora ‚Äî your Digital Concierge</h1>
    <p>One QR code in the apartment is all it takes ‚Äî guests get instant answers and insider tips, and you earn more with zero extra effort.</p>
    <div class="ctas">
      <a class="btn primary" href="https://buy.stripe.com/dRmdRab5I2gycqN3nA0Jq00">Order Endora (with landing page)</a>
      <a class="btn ghost"   href="https://buy.stripe.com/aFaaEY0r4aN4cqN2jw0Jq01">Order Endora (without landing page)</a>
    </div>
  </section>

  <!-- DEMO -->
  <section class="demo">
    <div class="card">
      <h2>Live demo ‚Äî meet Endora</h2>
      <p>Ask anything: check-in, house rules, amenities, or local tips. Endora replies instantly.</p>

      <div class="chat-wrap">
        <!-- inline chat -->
        <div class="chat" id="inline">
          <div class="hdr"><span>üí¨ Endora <span class="sparkle" aria-hidden="true"></span></span><button style="display:none">√ó</button></div>
          <div class="log" id="inline-log"></div>
          <div class="input" id="inline-input">
            <input id="inline-q" placeholder="Ask e.g. ‚ÄòWhere‚Äôs a great place to eat tonight?‚Äô"/>
            <button id="inline-send">Send</button>
            <div class="typing" id="inline-typing" aria-hidden="true"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
          </div>
        </div>

        <!-- QR + bubble -->
        <div class="qr">
          <div class="qr-wrap">
            <a class="qr-box" id="qr-link" href="#" title="Scan to open the chat on your phone">
              <img id="qr-img" alt="QR code to open chat"/>
            </a>
            <div class="bubble" id="bubble">üí¨</div>
          </div>
          <div class="qr-info">
            <strong>Scan the QR</strong>
            Guests open the chat on their phone instantly ‚Äî no app required.
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- HOW IT WORKS -->
  <section class="section" id="how-it-works">
    <h2>How it works</h2>
    <p class="sub">Four simple steps to more revenue and happier guests.</p>
    <div class="steps">
      <div class="step"><div class="num">1</div><h4>Place the QR code</h4><p>Stick it in the apartment ‚Äî done in 30 seconds.</p></div>
      <div class="step"><div class="num">2</div><h4>Guests scan</h4><p>They scan ‚Üí the chat opens instantly, no app needed.</p></div>
      <div class="step"><div class="num">3</div><h4>Recommendations</h4><p>Insider tips + vetted services directly in chat.</p></div>
      <div class="step"><div class="num">4</div><h4>Earn automatically</h4><p>Great service and commissions with zero extra work.</p></div>
    </div>

    <div class="features">
      <div class="feature"><div class="tick">‚úì</div><div>Plug & play ‚Äî ready in minutes</div></div>
      <div class="feature"><div class="tick">‚úì</div><div>Runs in your branding (white-label)</div></div>
      <div class="feature"><div class="tick">‚úì</div><div>GDPR-compliant, EU hosting</div></div>
      <div class="feature"><div class="tick">‚úì</div><div>Extra revenue with no extra work</div></div>
      <div class="feature"><div class="tick">‚úì</div><div>Franchise partner option</div></div>
      <div class="feature"><div class="tick">‚úì</div><div>24/7 coverage ‚Äî nights & weekends</div></div>
    </div>

    <!-- PRICING -->
    <div class="pricing" id="pricing">
      <h2>Pricing</h2>
      <p class="sub">Prices shown are VAT-exclusive where applicable.</p>
      <div class="cards">
        <!-- Endora monthly FIRST -->
        <div class="price">
          <div class="row"><h3>Endora (subscription)</h3><div class="amt"><span class="e">‚Ç¨</span>9.00/month</div></div>
          <p>Your subscription to your digital concierge service ‚Äî more revenue, less work, happier guests. Billed monthly.</p>
        </div>

        <div class="price">
          <div class="row"><h3>Setup with landing page</h3><div class="amt"><span class="e">‚Ç¨</span>250.00</div></div>
          <p>Create a landing page for the Accommodation Concierge (AC). Includes 3 revisions ‚Ä¢ hosted under an Eudemonia URL ‚Ä¢ QR code creation ‚Ä¢ AC integration ‚Ä¢ hosting as long as the AC subscription is active.</p>
        </div>

        <div class="price">
          <div class="row"><h3>Setup without landing page</h3><div class="amt"><span class="e">‚Ç¨</span>90.00</div></div>
          <p>Use your own landing page for the AC. We provide the code snippet to embed (JSON/HTML skills required). You provide the final URL we store in our database for routing ‚Ä¢ includes QR code creation.</p>
        </div>
      </div>
      <div class="ctas" style="margin-top:18px">
        <a class="btn ghost" href="mailto:info@eudemonia-coaching.de">Affiliate / partners / custom offers</a>
      </div>
    </div>
  </section>

  <!-- FOOTER CTAs -->
  <section class="footer">
    <div class="btnbar">
      <a class="btn primary" href="https://buy.stripe.com/dRmdRab5I2gycqN3nA0Jq00">Order Endora (with landing page)</a>
      <a class="btn ghost" href="https://buy.stripe.com/aFaaEY0r4aN4cqN2jw0Jq01">Order Endora (without landing page)</a>
      <a class="btn ghost" href="mailto:info@eudemonia-coaching.de">Affiliate / partners / custom offers</a>
    </div>
    <div class="links">
      <a href="https://concierge.eudemonia-coaching.de/clients/legal" target="_blank" rel="noopener">Legal Notice</a> |
      <a href="https://concierge.eudemonia-coaching.de/clients/legal" target="_blank" rel="noopener">Privacy Policy</a> |
      <a href="https://concierge.eudemonia-coaching.de/clients/legal" target="_blank" rel="noopener">Terms & Conditions</a>
    </div>
  </section>
</div>

<!-- Popup (opens from QR/bubble) -->
<div id="overlay" style="position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(6px);display:none;z-index:999"></div>
<div id="popup" style="position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:1000;display:none;width:min(92vw,520px)">
  <div class="chat">
    <div class="hdr"><span>üí¨ Endora <span class="sparkle" aria-hidden="true"></span></span><button id="close">√ó</button></div>
    <div class="log" id="pop-log"></div>
    <div class="input" id="pop-input">
      <input id="pop-q" placeholder="Ask about check-in, amenities, local tips‚Ä¶"/>
      <button id="pop-send">Send</button>
      <div class="typing" id="pop-typing" aria-hidden="true"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
    </div>
  </div>
</div>

<script>
(() => {
  // -------- Config --------
  const WEBHOOK = "https://automation.eudemonia-coaching.de/webhook/477363f3-7434-4c31-92e5-fb4da3db4150";

  // -------- Utils --------
  function prettyLabel(href, max=48){
    try{
      const u = new URL(href);
      let host = u.hostname.replace(/^www\./,'');
      let path = (u.pathname || '').replace(/\/$/,'');
      if(path.length>24) path = path.slice(0,24)+'‚Ä¶';
      const label = host + (path ? '/'+path : '');
      return label.length>max ? label.slice(0,max)+'‚Ä¶' : label;
    }catch{ return href.length>max ? href.slice(0,max)+'‚Ä¶' : href; }
  }
  function linkifyInto(container){
    const URL_RE=/((https?:\/\/|www\.)[^\s<>"'`]+)(?![^<]*>)/gi;
    const walk=(node)=>{
      if(node.nodeType===3){
        const t=node.nodeValue; if(!t) return;
        const frag=document.createDocumentFragment(); let m,last=0;
        URL_RE.lastIndex=0;
        while((m=URL_RE.exec(t))!==null){
          const raw=m[0]; const href=raw.startsWith('www.')?('https://'+raw):raw;
          const endClean=raw.replace(/[),.;!?]+$/,'');
          if(m.index>last) frag.appendChild(document.createTextNode(t.slice(last,m.index)));
          const a=document.createElement('a'); a.href=href; a.target="_blank"; a.rel="noopener nofollow";
          a.textContent=prettyLabel(href);
          frag.appendChild(a);
          last=m.index+raw.length;
          const trailing=raw.slice(endClean.length); if(trailing) frag.appendChild(document.createTextNode(trailing));
        }
        if(last===0) return;
        if(last<t.length) frag.appendChild(document.createTextNode(t.slice(last)));
        node.parentNode.replaceChild(frag,node);
      } else if(node.nodeType===1){ Array.from(node.childNodes).forEach(walk); }
    };
    walk(container);
  }
  function addMsg(log, text, who='bot'){
    const d=document.createElement('div'); d.className='msg '+who; d.textContent=text;
    if(who==='bot') linkifyInto(d);
    log.appendChild(d); log.scrollTop=log.scrollHeight;
  }
  function showTyping(inputEl, typingEl, on){
    inputEl.classList.toggle('waiting', on);
    typingEl.classList.toggle('show', on);
  }
  async function readAsText(res){
    const ct=(res.headers.get('content-type')||'').toLowerCase();
    if(ct.includes('application/json')){
      try{
        const j=await res.json();
        if(typeof j==='string') return j;
        const pick=j.output||j.answer||j.text||j.message||j.content||(j.choices?.[0]?.message?.content)||j.choices?.[0]?.text;
        return pick ? String(pick) : '';
      }catch{return '';}
    }
    try{ return await res.text(); }catch{return '';}
  }
  async function sendQuestion(q, meta={}){
    const body={ question:q, url:location.href, meta };
    const res=await fetch(WEBHOOK,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json,text/plain;q=0.9,*/*;q=0.8'},body:JSON.stringify(body)});
    return await readAsText(res);
  }

  // -------- Wire inline chat --------
  const inline={log:$('#inline-log'), input:$('#inline-input'), typing:$('#inline-typing'), q:$('#inline-q'), send:$('#inline-send')};
  const pop={wrap:$('#popup'), ovl:$('#overlay'), log:$('#pop-log'), input:$('#pop-input'), typing:$('#pop-typing'), q:$('#pop-q'), send:$('#pop-send'), close:$('#close')};
  welcome(inline.log); welcome(pop.log);

  function $(sel){return document.querySelector(sel)}
  function on(el,ev,fn){ el && el.addEventListener(ev,fn) }

  async function handleSend(ctx, source){
    const q=(ctx.q.value||'').trim(); if(!q) return;
    addMsg(ctx.log,q,'user'); ctx.q.value=''; showTyping(ctx.input, ctx.typing, true);
    try{
      const ans=await sendQuestion(q,{source});
      showTyping(ctx.input, ctx.typing, false);
      addMsg(ctx.log, (ans||'No answer received.').trim(), 'bot');
    }catch(e){
      showTyping(ctx.input, ctx.typing, false);
      addMsg(ctx.log,'No answer received.','bot');
    }
  }
  on(inline.send,'click',()=>handleSend(inline,'inline'));
  on(pop.send,'click',()=>handleSend(pop,'popup'));
  on(inline.q,'keydown',e=>{ if(e.key==='Enter') handleSend(inline,'inline') });
  on(pop.q,'keydown',e=>{ if(e.key==='Enter') handleSend(pop,'popup') });

  // -------- QR & popup --------
  const qrImg=$('#qr-img'), qrLink=$('#qr-link'), bubble=$('#bubble');
  const urlBase = location.origin + location.pathname; // no hash ‚Äî popup opens via JS
  const src1='https://quickchart.io/qr?text='+encodeURIComponent(urlBase)+'&size=512&margin=8&ecLevel=H&format=png&dark=%23000000&light=%23ffffff';
  const src2='https://chart.googleapis.com/chart?cht=qr&chs=512x512&chld=H|1&chl='+encodeURIComponent(urlBase);
  const src3='https://api.qrserver.com/v1/create-qr-code/?size=512x512&data='+encodeURIComponent(urlBase);
  qrImg.onerror=()=>{ if(qrImg.dataset.fallback==='2') qrImg.src=src3; else if(qrImg.dataset.fallback==='1'){ qrImg.dataset.fallback='2'; qrImg.src=src2; } else { qrImg.dataset.fallback='1'; qrImg.src=src2; } };
  qrImg.src=src1;

  function openPopup(){ pop.ovl.style.display='block'; pop.wrap.style.display='block'; setTimeout(()=>pop.q.focus(),80) }
  function closePopup(){ pop.ovl.style.display='none'; pop.wrap.style.display='none' }
  on(qrLink,'click',e=>{ e.preventDefault(); openPopup(); });
  on(bubble,'click',openPopup);
  on(pop.close,'click',closePopup);
  on(pop.ovl,'click',closePopup);

  // -------- Welcome rewrite (exact sentence) --------
  function welcome(log){
    addMsg(log,"Welcome! üëã I'm Endora, your Digital Concierge. Ask me anything about your stay.",'bot');
  }
})();
</script>
</body>
</html>
